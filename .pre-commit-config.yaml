repos:
  # æ£€æµ‹ AI API Keys - æ”¯æŒ OpenAI/Anthropic/Google ç­‰ä¸»æµ AI æœåŠ¡
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.5.0
    hooks:
      - id: detect-secrets
        name: Detect AI API Keys
        exclude: |
          (?x)^(
            package\.lock\.json|
            yarn\.lock
          )$

  # é¢å¤–æ£€æŸ¥ç¤ºä¾‹æ–‡ä»¶ - é˜²æ­¢çœŸå®å¯†é’¥æ··å…¥æ¨¡æ¿
  - repo: local
    hooks:
      - id: check-ai-keys
        name: Check AI Keys in All Files
        entry: |
          bash -c '
            # æ£€æµ‹ AI API Key æ¨¡å¼
            AI_KEY_PATTERNS=(
              # OpenAI
              "sk-[a-zA-Z0-9]{30,}"
              "sk-proj-[a-zA-Z0-9]{30,}"
              
              # Anthropic (Claude)
              "sk-ant-api[0-9]+-[a-zA-Z0-9]{20,}"
              
              # Google AI
              "AIza[0-9A-Za-z_-]{20,}"
              
              # OpenRouter
              "sk-or-v1-[a-zA-Z0-9]{30,}"
              
              # é˜¿é‡Œäº‘ç™¾ç‚¼ (Bailian/DashScope)
              "sk-[a-f0-9]{32}"
              
              # æœˆä¹‹æš—é¢ (Moonshot/Kimi)
              "sk-[a-zA-Z0-9]{48}"
              
              # æ™ºè°± AI (ChatGLM/GLM)
              "[a-f0-9]{32}\.[a-zA-Z0-9]{6,}"
              
              # ç™¾åº¦æ–‡å¿ƒ (ERNIE)
              "[a-zA-Z0-9]{24}"
              
              # è®¯é£æ˜Ÿç« (iFlytek Spark)
              "[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}"
              
              # DeepSeek
              "sk-[a-f0-9]{32}"
            )
            
            # æ„å»ºæ­£åˆ™è¡¨è¾¾å¼
            PATTERN=$(IFS="|"; echo "${AI_KEY_PATTERNS[*]}")
            
            # æ£€æŸ¥æš‚å­˜åŒºå˜æ›´
            if git diff --cached | grep -E "^\+.*(KEY|SECRET|TOKEN).*=.*($PATTERN)"; then
              echo "âŒ æ£€æµ‹åˆ°çœŸå® AI API Keyï¼"
              echo "ğŸ’¡ æ”¯æŒçš„æœåŠ¡: OpenAI, Anthropic, Google, OpenRouter, ç™¾ç‚¼, æœˆä¹‹æš—é¢, æ™ºè°±, æ–‡å¿ƒ, æ˜Ÿç«, DeepSeek"
              echo "ğŸ’¡ è¯·ä½¿ç”¨å ä½ç¬¦ï¼Œå¦‚: your_api_key_here"
              exit 1
            fi
          '
        language: system
        files: \.(py|js|ts|json|yml|yaml|env|example|sample|template|md|txt|sh)$
